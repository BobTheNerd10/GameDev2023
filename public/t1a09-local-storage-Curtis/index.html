<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<!--Site sheets-->
	<link rel="stylesheet" href="../printStyle.css">
	<script src="../common.js" defer></script>
</head>
<body>
    <header>
        <!--Dummy tag, will be filled in with JS if needed-->
    </header>
    

    <!--
        Click on entries to remove
        Have an undo button
    -->


    <main onload="onPageLoad()" onunload="onPageUnload()">
        
        <h1 style="margin-block-end:0">T1A09-local-storage-Curtis</h1>
        <h4 style="margin-block-start:0; font-weight:200;">(year 2)</h4>
        
        <p>
            If you put stuff in the todo list, you can refresh the page and it'll stay there!
        </p>

        <hr>

        <section>

            <br>

            Add to list: <input type="text" id="inputField"> 
        
            <button onclick="">Add Input to List</button>
            <button onclick="">Delete All</button>
            <button onclick="">Undo</button>

            <br><br>

            <ul id="todoList">
                <!--Fill me using javascript-->
            </ul>       
        </section>
    </main>

    <script defer>
        class EditableTodoList 
        {
            constructor(element, entries = [])
            {
                this.element = element

                this.entries = entries // Todo list entries (list of strings)
                this.entryCounter = 0 // This is a bit hacky, but realistically, no one is going to have so many todo list entries that they hit the integer limit, plus it resets on page refresh

                this.undoBuffer = entries

                this.drawTodoList()
            }

            drawTodoList()
            {
                this.element.innerHTML = ""
                
                for(let entry of this.entries)
                {
                    this.element.innerHTML += entry
                }
            }

            tryUndo()
            {
                this.contents = this.undoBuffer
                this.drawTodoList()
            }

            addListEntry(todoText = '')
            {
                this.entryCounter += 1

                // This line is garbo
                let todoEntry = `<li id="Entry${this.entryCounter}" onmousehover="document.getElementById('Entry${this.entryCounter}').style.textDecoration = 'line-through'" onmouseout="document.getElementById('Entry${this.entryCounter}').style.textDecoration = 'none'"onclick="">${todoText}</li>`
                
                this.entries.push(todoEntry) 
                
                this.drawTodoList()
            }
        }

        let todoObj = new EditableTodoList(document.getElementById("todoList"))
        todoObj.addListEntry("HeyHey")
        todoObj.addListEntry("twasfasdf")

        function onPageLoad() 
        {
            if(localStorage.getItem('todoListHTML') != null)
            {
                todoObj.element.innerHTML = localStorage.getItem('todoListHTML')
            }

            if(localStorage.getItem('todoListUndoBuffer') != null)
            {
                todoListUndoBuffer = localStorage.getItem('todoListUndoBuffer')
            }
        }


        function onPageUnload()
        {
            localStorage.setItem('todoListHTML', todoListElement.innerHTML)

            if(todoListUndoBuffer != null)
            {
                localStorage.setItem('todoListUndoBuffer', todoListUndoBuffer)
            }
        }
    </script>
</body>
</html>